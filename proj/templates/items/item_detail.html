<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>{{ item.name }}</title>
    <style>
      body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
      .header-links { margin-bottom: 20px; }
      .header-links a { color: #007bff; text-decoration: none; margin-right: 20px; }
      .header-links a:hover { text-decoration: underline; }
      .card { padding: 30px; border: 1px solid #ddd; border-radius: 8px; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
      h1 { margin: 0 0 15px; font-size: 28px; color: #333; }
      .description { color: #666; margin-bottom: 20px; line-height: 1.6; }
      .price { color: #28a745; font-size: 24px; font-weight: bold; margin-bottom: 25px; }
      button { background: #007bff; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 16px; }
      button:hover { background: #0056b3; }
      button:disabled { opacity: .6; cursor: not-allowed; }
      form { margin-top: 10px; }
    </style>
  </head>
  <body>
    <div class="header-links">
      <a href="{% url 'item_list' %}">← Back to Items</a>
      <a href="{% url 'order_list' %}">Orders</a>
      <a href="{% url 'create_order' %}">Create Order</a>
    </div>
    <div class="card">
      <h1>{{ item.name }}</h1>
      <div class="description">{{ item.description|default:"No description available." }}</div>
      
      <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px;">
        <label for="currency-selector" style="margin-right: 10px; font-weight: bold;">Currency:</label>
        <select id="currency-selector" name="currency" data-rate="{{ usd_to_eur_rate }}" style="padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
          <option value="usd" selected>USD - US Dollar</option>
          <option value="eur">EUR - Euro</option>
        </select>
      </div>
      
      <div class="price" id="price-display" data-usd-price="{{ item.price }}">${{ item.price }} USD</div>
      
      <form id="buy-form" method="GET" action="{% url 'item_buy' item.id %}">
        <input type="hidden" name="currency" id="currency-input" value="usd">
        <button type="submit" id="buyBtn">Buy Now</button>
      </form>
    </div>

    <script>
      const currencySelector = document.getElementById('currency-selector');
      const priceDisplay = document.getElementById('price-display');
      const currencyInput = document.getElementById('currency-input');
      const usdToEurRate = parseFloat(currencySelector.getAttribute('data-rate'));
      
      // Update price display when currency changes
      currencySelector.addEventListener('change', () => {
        const selectedCurrency = currencySelector.value;
        const usdPrice = parseFloat(priceDisplay.getAttribute('data-usd-price'));
        currencyInput.value = selectedCurrency;
        
        if (selectedCurrency === 'eur') {
          const eurPrice = (usdPrice * usdToEurRate).toFixed(2);
          priceDisplay.textContent = `€${eurPrice} EUR`;
        } else {
          priceDisplay.textContent = `$${usdPrice.toFixed(2)} USD`;
        }
      });
    </script>
  </body>
</html>